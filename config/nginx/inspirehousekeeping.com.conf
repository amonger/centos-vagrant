upstream inspirehousekbackend {
    server unix:/var/run/php-fcgi-inspirehousekeeping.com.sock;
}


server {
    autoindex on;
    listen 80;
    server_name inspirehousekeeping.co.uk;
    root /var/www/vhosts/inspirehousekeeping.com/htdocs;
    index index.php;
    access_log /var/www/vhosts/inspirehousekeeping.com/access.log;
    error_log /var/www/vhosts/inspirehousekeeping.com/error.log;
    proxy_temp_path /var/www/vhosts/inspirehousekeeping.com/tmp;
    #/etc/letsencrypt/live/inspirehousekeeping.co.uk/fullchain.pem
    #rewrite /insp_admin/ /insp_admin/index.php redirect;
    

#    ssl_certificate /etc/letsencrypt/live/inspirehousekeeping.co.uk/fullchain.pem;
#    ssl_certificate_key /etc/letsencrypt/live/inspirehousekeeping.co.uk/privkey.pem;
#
#    ########################################################################
#    # from https://cipherli.st/                                            #
#    # and https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html #
#    ########################################################################
#
#    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
#    ssl_prefer_server_ciphers on;
#    ssl_ciphers "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH";
#    ssl_ecdh_curve secp384r1;
#    ssl_session_cache shared:SSL:10m;
#    ssl_session_tickets off;
#    ssl_stapling on;
#    ssl_stapling_verify on;
#    resolver 8.8.8.8 8.8.4.4 valid=300s;
#    resolver_timeout 5s;
#    # Disable preloading HSTS for now.  You can use the commented out header line that includes
#    # the "preload" directive if you understand the implications.
#    #add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload";
#    add_header Strict-Transport-Security "max-age=63072000; includeSubdomains";
#    add_header X-Frame-Options DENY;
#    add_header X-Content-Type-Options nosniff;
#
#    ##################################
#    # END https://cipherli.st/ BLOCK #
#    ##################################

    #ssl_dhparam /etc/ssl/certs/dhparam.pem;

    location / {
#        fastcgi_pass   127.0.0.1:9000;
        fastcgi_pass inspirehousekbackend;
#       fastcgi_pass   unix:/var/run/php-fcgi-inspirehousekeeping.com.sock;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        include        fastcgi_params; 
        try_files $uri $uri/ /index.php?$query_string;
    }

    location /images {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/images;
    }

    location /scripts {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/scripts;
    }

    location /style {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/style;
    }


    location /js {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/js;
    }
 
    location /SpryAssets {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/SpryAssets;
    }
 
    location /css {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/css;
    }

    location /nsa.css {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/nsa.css;
    }

    location nsa02.css {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/nsa02.css;
    }

    location scape.js {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/scape.js;
    }

    location graphics02 {
        alias /var/www/vhosts/inspirehousekeeping.com/inspire-housekeeping/legacy/graphics02;
   }
    location ~ /.well-known {
            allow all;
    }

   location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
       expires max;
       log_not_found off;
   }
}

server {
    listen 80;
    server_name www.inspirehousekeeping.com www.inspirehousekeeping.co.uk inspirehousekeeping.com inspirehousekeeping.co.uk;

    location / {
        return 301 https://inspirehousekeeping.co.uk$request_uri;
    }
}

server {
    listen 443;
    server_name www.inspirehousekeeping.com www.inspirehousekeeping.co.uk inspirehousekeeping.com;

    root /var/www/vhosts/inspirehousekeeping.com/redirect;

    location ~ /.well-known {
        allow all;
    }

    location / {
    #    return 301 https://inspirehousekeeping.co.uk$request_uri;
    }
}
